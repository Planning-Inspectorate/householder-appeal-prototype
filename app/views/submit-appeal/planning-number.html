{% extends "layout.html" %}

{% block pageTitle %}
  Your details
{% endblock %}

{% block content %}

<div class="govuk-grid-row" id="form-html">
  <div class="govuk-grid-column-two-thirds">
    <form action="planning-number-post" method="post" novalidate id="planing-number-submit">
      
      <div class="govuk-form-group">
        <h1 class="govuk-label-wrapper"><label class="govuk-label govuk-label--l" for="postcode">
            What is your original planning application number?
          </label>
        </h1>
        <div id="application-number-hint" class="govuk-hint">
          You can find this on the decision letter from your local planning department
        </div>
        <input class="govuk-input govuk-input--width-10" id="reference" name="reference" type="text">
      </div>


      <div class="govuk-form-group">
        <button class="govuk-button" data-module="govuk-button">
          Continue
        </button>
      </div>
    </form>
  </div>
</div>

<div class="govuk-grid-row govuk-!-display-none" id="waiting-html">
    <div class="govuk-grid-column-two-thirds">

    <h1 class="govuk-heading-l">Searching for your planning application</h1>

      <div class="ccms-loader"></div>
    <p>We are searching for your planning application from South Gloucestershire Council. This usually takes up to 30 seconds. </p>

  </div>
</div>

{% endblock %}


{% block pageScripts %}
<script>


$(document).on("submit", "#planing-number-submit", function(event){
  event.preventDefault();
  console.log(event);

  $("#form-html").hide();
  $("#waiting-html").removeClass("govuk-!-display-none");

  
  let caseref = $("#reference").val();

  $.post("/submit-appeal/planning-number-post",
    {
      "caseref": caseref 
    },
    function(data, status){
      let url = window.location.origin + "/submit-appeal/appeal-details";
      window.location = url
    });

  
})


</script>
{% endblock %}